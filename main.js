!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}function n(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var r=function(){return e=function e(t,n,r,o){var i=r.handleCardClick,u=r.handlerDeleteCard,a=r.handlerAddLike,c=r.handlerRemoveLike;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t.name,this._link=t.link,this._likes=t.likes||0,this._id=t._id,this._owner=t.owner,this._currentUser=o,this._templateSelector=n,this._handleCardClick=i,this._handlerDeleteCard=u,this._handlerAddLike=a,this._handlerRemoveLike=c},(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}},{key:"_setEventListeners",value:function(e){var t=this,n=e.querySelector(".element__trash"),r=e.querySelector(".element__button_liked"),o=e.querySelector(".element__image");n.addEventListener("click",(function(){t._handlerDeleteCard(e,t._id)})),r.addEventListener("click",(function(){t._hasLikeOwner()?t._handlerRemoveLike(t._id).then((function(n){t._likes=n.likes,e.querySelector(".element__likes-count").textContent=t._likes.length,r.classList.add("element__button_liked")})):t._handlerAddLike(t._id).then((function(n){t._likes=n.likes,e.querySelector(".element__likes-count").textContent=t._likes.length,r.classList.remove("element__button_liked")}))})),o.addEventListener("click",(function(){t._handleCardClick(t._name,t._link)}))}},{key:"_hasLikeOwner",value:function(){var e=this;return this._likes.some((function(t){return t._id===e._currentUser._id}))}},{key:"_isMe",value:function(){return this._owner._id===this._currentUser._id}},{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._element.querySelector(".element__image").src=this._link,this._element.querySelector(".element__image").alt=this._name,this._element.querySelector(".element__place").textContent=this._name,this._element.querySelector(".element__likes-count").textContent=this._likes.length,this._setEventListeners(this._element),this._hasLikeOwner()&&this._element.querySelector(".element__button_liked").classList.remove("element__button_liked"),this._isMe()||this._element.querySelector(".element__trash").remove(),this._element}}])&&t(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}();function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}var a=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._settings=t,this._formElement=n},(t=[{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(this._settings.inputErrorClass),n.textContent=t,n.classList.add(this._settings.errorClass)}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._settings.inputErrorClass),t.textContent="",t.classList.remove(this._settings.errorClass)}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_toggleButtonState",value:function(){var e=this._inputList.every((function(e){return e.validity.valid})),t=this._inputList.some((function(e){return""!==e.value.trim()})),n=this._formElement.querySelector(this._settings.submitButtonSelector);e&&t?(n.classList.remove(this._settings.inactiveButtonClass),n.disabled=!1):(n.classList.add(this._settings.inactiveButtonClass),n.disabled=!0)}},{key:"_setEventListeners",value:function(){var e=this;this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))})),this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._toggleButtonState()}},{key:"enableValidation",value:function(){this._setEventListeners()}}])&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=c(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}var f=function(){return e=function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.items=r,this.renderer=o,this.container=document.querySelector(n)},(t=[{key:"rendererItems",value:function(){var e=this;this.items.forEach((function(t){e.renderer(t)}))}},{key:"addItem",value:function(e){this.container.appendChild(e)}}])&&l(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e,t){if("object"!=p(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}var d=function(){return e=function e(t){var n,r,o,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,o=function(e){"Escape"===e.key&&i.close()},(r=m(r="_handleEscClose"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this._popup=document.querySelector(t)},(t=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("click",(function(t){(t.target.classList.contains("popup")||t.target.classList.contains("popup__container-close-button-image"))&&e.close()}))}}])&&y(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function b(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:t+""}function _(e,t,n){return t=k(t),function(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,g()?Reflect.construct(t,n||[],k(e).constructor):t.apply(e,n))}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(g=function(){return!!e})()}function S(){return S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},S.apply(this,arguments)}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}var w=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=_(this,t,[e]))._popupImage=n._popup.querySelector(".image-popup__image"),n._popupTitle=n._popup.querySelector(".image-popup__title"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(t,e),n=t,(r=[{key:"open",value:function(e,n){S(k(t.prototype),"open",this).call(this),this._popupImage.src=e,this._popupImage.alt=n,this._popupTitle.textContent=n,this._popup.style.display="block"}},{key:"close",value:function(){S(k(t.prototype),"close",this).call(this),this._popup.style.display="none"}},{key:"setEventListeners",value:function(){var e=this;S(k(t.prototype),"setEventListeners",this).call(this),this._popup.addEventListener("click",(function(t){(t.target.classList.contains("image-popup")||t.target.classList.contains("image-popup__content")||t.target.classList.contains("image-popup__close-button-icon"))&&e.close()}))}}])&&h(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(d);function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L(r.key),r)}}function L(e){var t=function(e,t){if("object"!=j(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==j(t)?t:t+""}function P(e,t,n){return t=I(t),function(e,t){if(t&&("object"===j(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,C()?Reflect.construct(t,n||[],I(e).constructor):t.apply(e,n))}function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(C=function(){return!!e})()}function q(){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=I(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},q.apply(this,arguments)}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}var B=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=P(this,t,[e]))._submitCallback=n,r._form=r._popup.querySelector(".form"),r._inputList=r._form.querySelectorAll(".form__input"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(t,e),n=t,(r=[{key:"_getInputValues",value:function(){var e={};return this._inputList.forEach((function(t){e[t.name]=t.value})),e}},{key:"setEventListeners",value:function(){var e=this;q(I(t.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){t.preventDefault(),e._form.querySelector(".form__submit").textContent="Guardando...",e._submitCallback(e._getInputValues()).then((function(){e._form.querySelector(".form__submit").textContent="Guardar"})).finally((function(){t.target.reset(),e.close()}))}))}},{key:"close",value:function(){q(I(t.prototype),"close",this).call(this),this._form.reset()}}])&&O(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(d);function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function x(e){var t=function(e,t){if("object"!=U(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=U(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==U(t)?t:t+""}var A=function(){return e=function e(t){var n=t.nameSelector,r=t.roleSelector,o=t.avatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._nameElement=document.querySelector(n),this._roleElement=document.querySelector(r),this._avatarElement=document.querySelector(o)},(t=[{key:"getUserInfo",value:function(){return{name:this._nameElement.textContent,role:this._roleElement.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;this._nameElement.textContent=t,this._roleElement.textContent=n}},{key:"setUserAvatar",value:function(e){this._avatarElement.src=e}}])&&R(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,M(r.key),r)}}function M(e){var t=function(e,t){if("object"!=D(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==D(t)?t:t+""}function N(e,t,n){return t=H(t),function(e,t){if(t&&("object"===D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,J()?Reflect.construct(t,n||[],H(e).constructor):t.apply(e,n))}function J(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(J=function(){return!!e})()}function G(){return G="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=H(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},G.apply(this,arguments)}function H(e){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},H(e)}function z(e,t){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},z(e,t)}var F=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=N(this,t,[e]))._confirmCallback=n,r._yesButton=r._popup.querySelector(".popup__confirm-button_yes"),r._noButton=r._popup.querySelector(".popup__confirm-button_no"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}(t,e),n=t,(r=[{key:"setEventListeners",value:function(){var e=this;G(H(t.prototype),"setEventListeners",this).call(this),this._yesButton.addEventListener("click",(function(){e._confirmCallback(),e.close()})),this._noButton.addEventListener("click",(function(){e.close()}))}}])&&V(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(d);function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,W(r.key),r)}}function W(e){var t=function(e,t){if("object"!=K(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==K(t)?t:t+""}var X=new(function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers},(t=[{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"addCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"addLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"removeLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"updateUserInfo",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"updateAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}}])&&Q(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}())({baseUrl:"https://around.nomoreparties.co/v1/web_es_12",headers:{authorization:"41f14ad4-27da-40cd-a7c6-47b18a7a7e9f","Content-Type":"application/json"}}),Y=(document.getElementById("popup"),document.querySelector(".profile__name")),Z=document.querySelector(".profile__role"),$=document.getElementById("editButton"),ee=document.getElementById("addButton"),te=(document.getElementById("closeEditButton"),document.getElementById("saveEditButton"),document.getElementById("closeCardButton"),document.getElementById("saveCardButton"),document.querySelector(".elements")),ne=document.querySelector(".profile__avatar"),re={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit",inactiveButtonClass:"form__submit_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},oe=null,ie=null;function ue(e,t){me.open(t,e)}X.getUserInfo().then((function(e){return ie=e,he.setUserInfo(e),he.setUserAvatar(e.avatar),X.getInitialCards()})).then((function(e){(oe=new f({items:e,renderer:function(e){var t=new r(e,".template",{handleCardClick:ue,handlerDeleteCard:function(e,t){be={cardElement:e,_id:t},_e.open()},handlerAddLike:function(e){return X.addLike(e)},handlerRemoveLike:function(e){return X.removeLike(e)}},ie),n=t.generateCard();oe.addItem(n)}},".elements")).rendererItems()}));var ae=document.getElementById("form-profile"),ce=document.querySelector(".popup_tarjeta form"),le=document.querySelector(".popup_avatar form"),se=new a(re,ae),fe=new a(re,ce),pe=new a(re,le);se.enableValidation(),fe.enableValidation(),pe.enableValidation();var ye=new d(".popup");ye.setEventListeners(),ye.open(),ye.close();var me=new w(".image-popup");me.setEventListeners();var de=new B(".popup",(function(e){var t=e.name,n=e.about;return X.updateUserInfo({name:t,about:n}).then((function(e){he.setUserInfo({name:t,about:n})}))}));de.setEventListeners();var ve=new B(".popup_tarjeta",(function(e){var t=e.title,n=e.url;return X.addCard({name:t,link:n}).then((function(e){var t=new r(e,".template",{handleCardClick:ue,handlerDeleteCard:function(e,t){be={cardElement:e,_id:t},_e.open()},handlerAddLike:function(e){return X.addLike(e)},handlerRemoveLike:function(e){return X.removeLike(e)}},ie).generateCard();te.prepend(t)}))}));ve.setEventListeners();var he=new A({nameSelector:".profile__name",roleSelector:".profile__role",avatarSelector:".profile__avatar-image"});ee.addEventListener("click",(function(){titleInput.value="",urlInput.value="",ve.open()})),$.addEventListener("click",(function(){nameInput.value=Y.textContent,aboutMeInput.value=Z.textContent,de.open()}));var be=null,_e=new F("#confirmPopup",(function(){be&&X.deleteCard(be._id).then((function(){be.cardElement.remove(),console.log("Tarjeta eliminada")}))}));_e.setEventListeners(),document.querySelectorAll(".element__trash").forEach((function(e){e.addEventListener("click",(function(){_e.open()}))}));var ge=new B(".popup_avatar",(function(e){var t=e.avatar;return X.updateAvatar({avatar:t}).then((function(e){he.setUserAvatar(e.avatar)}))}));ge.setEventListeners(),ne.addEventListener("click",(function(){ge.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFTRSxjQUFjdkwsRUFBSzRJLE9BQzlCLEdBQ0YsSUFFQTZFLEdBQVloQixvQkFFWjlCLEdBQVd2SSxpQkFBaUIsU0FBUyxXQUNuQ3FMLEdBQVl4QyxNQUNkLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBkYXRhLFxuICAgIHRlbXBsYXRlU2VsZWN0b3IsXG4gICAgeyBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZXJEZWxldGVDYXJkLCBoYW5kbGVyQWRkTGlrZSwgaGFuZGxlclJlbW92ZUxpa2UgfSxcbiAgICBjdXJyZW50VXNlclxuICApIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzIHx8IDA7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9vd25lciA9IGRhdGEub3duZXI7XG4gICAgdGhpcy5fY3VycmVudFVzZXIgPSBjdXJyZW50VXNlcjtcbiAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlckRlbGV0ZUNhcmQgPSBoYW5kbGVyRGVsZXRlQ2FyZDtcbiAgICB0aGlzLl9oYW5kbGVyQWRkTGlrZSA9IGhhbmRsZXJBZGRMaWtlO1xuICAgIHRoaXMuX2hhbmRsZXJSZW1vdmVMaWtlID0gaGFuZGxlclJlbW92ZUxpa2U7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICByZXR1cm4gdGVtcGxhdGU7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoY2FyZEVsZW1lbnQpIHtcbiAgICBjb25zdCB0cmFzaEljb24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3RyYXNoXCIpO1xuICAgIGNvbnN0IGxpa2VCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2J1dHRvbl9saWtlZFwiKTtcbiAgICBjb25zdCBpbWFnZU5vZGUgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2ltYWdlXCIpO1xuXG4gICAgdHJhc2hJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVyRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgdGhpcy5faWQpO1xuICAgIH0pO1xuICAgIGxpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLl9oYXNMaWtlT3duZXIoKSkge1xuICAgICAgICB0aGlzLl9oYW5kbGVyUmVtb3ZlTGlrZSh0aGlzLl9pZCkudGhlbigoY2FyZCkgPT4ge1xuICAgICAgICAgIHRoaXMuX2xpa2VzID0gY2FyZC5saWtlcztcbiAgICAgICAgICBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2xpa2VzLWNvdW50XCIpLnRleHRDb250ZW50ID1cbiAgICAgICAgICAgIHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICAgICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJlbGVtZW50X19idXR0b25fbGlrZWRcIik7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5faGFuZGxlckFkZExpa2UodGhpcy5faWQpLnRoZW4oKGNhcmQpID0+IHtcbiAgICAgICAgICB0aGlzLl9saWtlcyA9IGNhcmQubGlrZXM7XG4gICAgICAgICAgY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saWtlcy1jb3VudFwiKS50ZXh0Q29udGVudCA9XG4gICAgICAgICAgICB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiZWxlbWVudF9fYnV0dG9uX2xpa2VkXCIpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLypcbiAgICAgIHRoaXMuX2xpa2VzLmxlbmd0aCArPSAxOyAvLyBJbmNyZW1lbnRhIGxvcyBcIm1lIGd1c3RhXCJcbiAgICAgIGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fbGlrZXMtY291bnRcIikudGV4dENvbnRlbnQgPVxuICAgICAgICB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJlbGVtZW50X19idXR0b25fbGlrZWRcIik7XG4gICAgKi9cbiAgICB9KTtcbiAgICBpbWFnZU5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcbiAgICB9KTtcbiAgfVxuXG4gIF9oYXNMaWtlT3duZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSB0aGlzLl9jdXJyZW50VXNlci5faWQpO1xuICB9XG5cbiAgX2lzTWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX293bmVyLl9pZCA9PT0gdGhpcy5fY3VycmVudFVzZXIuX2lkO1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19wbGFjZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2xpa2VzLWNvdW50XCIpLnRleHRDb250ZW50ID1cbiAgICAgIHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycyh0aGlzLl9lbGVtZW50KTtcbiAgICBpZiAodGhpcy5faGFzTGlrZU93bmVyKCkpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fYnV0dG9uX2xpa2VkXCIpXG4gICAgICAgIC5jbGFzc0xpc3QucmVtb3ZlKFwiZWxlbWVudF9fYnV0dG9uX2xpa2VkXCIpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5faXNNZSgpKSB7XG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fdHJhc2hcIikucmVtb3ZlKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBjb25zdCBpc0Zvcm1WYWxpZCA9IHRoaXMuX2lucHV0TGlzdC5ldmVyeShcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxuICAgICk7XG5cbiAgICBjb25zdCBpc0FueUZpZWxkRmlsbGVkID0gdGhpcy5faW5wdXRMaXN0LnNvbWUoXG4gICAgICAoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsdWUudHJpbSgpICE9PSBcIlwiXG4gICAgKTtcblxuICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG5cbiAgICBpZiAoaXNGb3JtVmFsaWQgJiYgaXNBbnlGaWVsZEZpbGxlZCkge1xuICAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxuICAgICk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXG4gICAgKTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuaXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlcmVySXRlbXMoKSB7XG4gICAgdGhpcy5pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLnJlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwXCIpIHx8XG4gICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fY29udGFpbmVyLWNsb3NlLWJ1dHRvbi1pbWFnZVwiKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldmVudCkgPT4ge1xuICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5pbWFnZS1wb3B1cF9faW1hZ2VcIik7XG4gICAgdGhpcy5fcG9wdXBUaXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuaW1hZ2UtcG9wdXBfX3RpdGxlXCIpO1xuICB9XG5cbiAgb3BlbihpbWFnZVNyYywgaW1hZ2VBbHQpIHtcbiAgICBzdXBlci5vcGVuKCk7XG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBpbWFnZVNyYztcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGltYWdlQWx0O1xuICAgIHRoaXMuX3BvcHVwVGl0bGUudGV4dENvbnRlbnQgPSBpbWFnZUFsdDtcbiAgICB0aGlzLl9wb3B1cC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9wb3B1cC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImltYWdlLXBvcHVwXCIpIHx8XG4gICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJpbWFnZS1wb3B1cF9fY29udGVudFwiKSB8fFxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiaW1hZ2UtcG9wdXBfX2Nsb3NlLWJ1dHRvbi1pY29uXCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIHN1Ym1pdENhbGxiYWNrKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fc3VibWl0Q2FsbGJhY2sgPSBzdWJtaXRDYWxsYmFjaztcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKTtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGZvcm1WYWx1ZXM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc3VibWl0XCIpLnRleHRDb250ZW50ID0gXCJHdWFyZGFuZG8uLi5cIjtcbiAgICAgIHRoaXMuX3N1Ym1pdENhbGxiYWNrKHRoaXMuX2dldElucHV0VmFsdWVzKCkpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc3VibWl0XCIpLnRleHRDb250ZW50ID0gXCJHdWFyZGFyXCI7XG4gICAgICAgIH0pXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICBldmVudC50YXJnZXQucmVzZXQoKTtcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIHJvbGVTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX3JvbGVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihyb2xlU2VsZWN0b3IpO1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIHJvbGU6IHRoaXMuX3JvbGVFbGVtZW50LnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX3JvbGVFbGVtZW50LnRleHRDb250ZW50ID0gYWJvdXQ7XG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBjb25maXJtQ2FsbGJhY2spIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9jb25maXJtQ2FsbGJhY2sgPSBjb25maXJtQ2FsbGJhY2s7IC8vIEZ1bmNpw7NuIGEgZWplY3V0YXIgcGFyYSBlbGltaW5hciBsYSB0YXJqZXRhXG4gICAgdGhpcy5feWVzQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY29uZmlybS1idXR0b25feWVzXCIpO1xuICAgIHRoaXMuX25vQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY29uZmlybS1idXR0b25fbm9cIik7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIC8vIEFncmVnYSBlbCBldmVudG8gY2xpY2sgYWwgYm90w7NuICdTw60nIHBhcmEgZWplY3V0YXIgbGEgZnVuY2nDs24gZGUgY29uZmlybWFjacOzblxuICAgIHRoaXMuX3llc0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5fY29uZmlybUNhbGxiYWNrKCk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG5cbiAgICAvLyBBZ3JlZ2EgZWwgZXZlbnRvIGNsaWNrIGFsIGJvdMOzbiAnTm8nIHBhcmEgc2ltcGxlbWVudGUgY2VycmFyIGVsIHBvcHVwXG4gICAgdGhpcy5fbm9CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkQ2FyZChkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgcmVtb3ZlTGlrZShjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGVVc2VySW5mbyhkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlQXZhdGFyKGRhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG59XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvd2ViX2VzXzEyXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjQxZjE0YWQ0LTI3ZGEtNDBjZC1hN2M2LTQ3YjE4YTdhN2U5ZlwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGFwaTtcbiIsImltcG9ydCBcIi4vcGFnZXMvaW5kZXguY3NzXCI7XG5cbmltcG9ydCBDYXJkIGZyb20gXCIuL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xuaW1wb3J0IGFwaSBmcm9tIFwiLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG5jb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicG9wdXBcIik7XG5jb25zdCBuYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmNvbnN0IHJvbGVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19yb2xlXCIpO1xuY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdEJ1dHRvblwiKTtcbmNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkQnV0dG9uXCIpO1xuY29uc3QgY2xvc2VFZGl0QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjbG9zZUVkaXRCdXR0b25cIik7XG5jb25zdCBzYXZlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2F2ZUVkaXRCdXR0b25cIik7XG5jb25zdCBjbG9zZUNhcmRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNsb3NlQ2FyZEJ1dHRvblwiKTtcbmNvbnN0IHNhdmVDYXJkQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzYXZlQ2FyZEJ1dHRvblwiKTtcbmNvbnN0IGVsZW1lbnRzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c1wiKTtcbmNvbnN0IGF2YXRhck5vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcblxuY29uc3QgY29uZmlnRm9ybSA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19zdWJtaXRcIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19zdWJtaXRfZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJmb3JtX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG4vLyBDb250ZW5pZG8gZGUgbGFzIHRhcmpldGFzXG4vKlxuY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJWYWxsZSBkZSBZb3NlbWl0ZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9uZXctbWFya2V0cy9XRUJfc3ByaW50XzUvRVMveW9zZW1pdGUuanBnXCIsXG4gICAgbGlrZXM6IDAsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL25ldy1tYXJrZXRzL1dFQl9zcHJpbnRfNS9FUy9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTW9udGHDsWFzIENhbHZhc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9uZXctbWFya2V0cy9XRUJfc3ByaW50XzUvRVMvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vbmV3LW1hcmtldHMvV0VCX3NwcmludF81L0VTL2xhdGVtYXIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlBhcnF1ZSBOYWNpb25hbCBkZSBsYSBWYW5vaXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL25ldy1tYXJrZXRzL1dFQl9zcHJpbnRfNS9FUy92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9uZXctbWFya2V0cy9XRUJfc3ByaW50XzUvRVMvbGFnby5qcGdcIixcbiAgfSxcbl07XG4qL1xuXG5sZXQgc2VjdGlvbiA9IG51bGw7XG5sZXQgY3VycmVudFVzZXIgPSBudWxsO1xubGV0IGluaXRpYWxDYXJkcyA9IG51bGw7XG5cbmFwaVxuICAuZ2V0VXNlckluZm8oKVxuICAudGhlbigodXNlcikgPT4ge1xuICAgIGN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyKTtcbiAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXIuYXZhdGFyKTtcbiAgICByZXR1cm4gYXBpLmdldEluaXRpYWxDYXJkcygpO1xuICB9KVxuICAudGhlbigoY2FyZHMpID0+IHtcbiAgICBpbml0aWFsQ2FyZHMgPSBjYXJkcztcbiAgICAvLyBDcmVhciBpbnN0YW5jaWEgZGUgbGEgY2xhc2UgU2VjdGlvblxuICAgIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICAgICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgICAgICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgICAgICAgICAgaXRlbSxcbiAgICAgICAgICAgIFwiLnRlbXBsYXRlXCIsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGhhbmRsZUNhcmRDbGljazogc2hvd0ltYWdlUG9wdXAsXG4gICAgICAgICAgICAgIGhhbmRsZXJEZWxldGVDYXJkOiAoY2FyZEVsZW1lbnQsIF9pZCkgPT4ge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRDYXJkID0geyBjYXJkRWxlbWVudCwgX2lkIH07XG4gICAgICAgICAgICAgICAgY29uZmlybVBvcHVwLm9wZW4oKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaGFuZGxlckFkZExpa2U6IChjYXJkSWQpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBpLmFkZExpa2UoY2FyZElkKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaGFuZGxlclJlbW92ZUxpa2U6IChjYXJkSWQpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBpLnJlbW92ZUxpa2UoY2FyZElkKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjdXJyZW50VXNlclxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xuICAgICAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgXCIuZWxlbWVudHNcIlxuICAgICk7XG4gICAgc2VjdGlvbi5yZW5kZXJlckl0ZW1zKCk7XG4gIH0pO1xuXG5mdW5jdGlvbiBzaG93SW1hZ2VQb3B1cChuYW1lLCBsaW5rKSB7XG4gIHBvcHVwV2l0aEltYWdlLm9wZW4obGluaywgbmFtZSk7XG59XG5cbi8vIENyZWFyIGluc3RhbmNpYSBkZSBsYSBjbGFzZSBGb3JtVmFsaWRhdG9yIHBhcmEgY2FkYSBmb3JtdWxhcmlvXG5jb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZvcm0tcHJvZmlsZVwiKTtcbmNvbnN0IG5ld0NhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90YXJqZXRhIGZvcm1cIik7XG5jb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9hdmF0YXIgZm9ybVwiKTtcblxuY29uc3QgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnRm9ybSwgZWRpdFByb2ZpbGVGb3JtKTtcblxuY29uc3QgbmV3Q2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWdGb3JtLCBuZXdDYXJkRm9ybSk7XG5cbmNvbnN0IG5ld0F2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWdGb3JtLCBhdmF0YXJGb3JtKTtcblxuZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbm5ld0NhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbm5ld0F2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBDcmVhciBpbnN0YW5jaWEgZGUgbGEgY2xhc2UgUG9wdXBcbmNvbnN0IHBvcHVwSW5zdGFuY2UgPSBuZXcgUG9wdXAoXCIucG9wdXBcIik7XG5wb3B1cEluc3RhbmNlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIEFicmlyIGVsIHBvcHVwXG5wb3B1cEluc3RhbmNlLm9wZW4oKTtcblxuLy8gQ2VycmFyIGVsIHBvcHVwXG5wb3B1cEluc3RhbmNlLmNsb3NlKCk7XG5cbi8vIENyZWFyIGluc3RhbmNpYSBkZSBsYSBjbGFzZSBQb3B1cFdpdGhJbWFnZVxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIuaW1hZ2UtcG9wdXBcIik7XG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBDcmVhciBpbnN0YW5jaWEgZGUgbGEgY2xhc2UgUG9wdXBXaXRoRm9ybVxuY29uc3QgcG9wdXBQcm9maWxlID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBcIiwgKHsgbmFtZSwgYWJvdXQgfSkgPT4ge1xuICAvLyBMw7NnaWNhIHBhcmEgbWFuZWphciBlbCBlbnbDrW8gZGVsIGZvcm11bGFyaW9cbiAgcmV0dXJuIGFwaS51cGRhdGVVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pLnRoZW4oKGRhdGEpID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pO1xuICB9KTtcbn0pO1xucG9wdXBQcm9maWxlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwVGFyamV0YSA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3RhcmpldGFcIiwgKHsgdGl0bGUsIHVybCB9KSA9PiB7XG4gIHJldHVybiBhcGkuYWRkQ2FyZCh7IG5hbWU6IHRpdGxlLCBsaW5rOiB1cmwgfSkudGhlbigoZGF0YSkgPT4ge1xuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICAgIGRhdGEsXG4gICAgICBcIi50ZW1wbGF0ZVwiLFxuICAgICAge1xuICAgICAgICBoYW5kbGVDYXJkQ2xpY2s6IHNob3dJbWFnZVBvcHVwLFxuICAgICAgICBoYW5kbGVyRGVsZXRlQ2FyZDogKGNhcmRFbGVtZW50LCBfaWQpID0+IHtcbiAgICAgICAgICBjdXJyZW50Q2FyZCA9IHsgY2FyZEVsZW1lbnQsIF9pZCB9O1xuICAgICAgICAgIGNvbmZpcm1Qb3B1cC5vcGVuKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGhhbmRsZXJBZGRMaWtlOiAoY2FyZElkKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGFwaS5hZGRMaWtlKGNhcmRJZCk7XG4gICAgICAgIH0sXG4gICAgICAgIGhhbmRsZXJSZW1vdmVMaWtlOiAoY2FyZElkKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGFwaS5yZW1vdmVMaWtlKGNhcmRJZCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgY3VycmVudFVzZXJcbiAgICApO1xuICAgIGNvbnN0IG5ld0NhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgICBlbGVtZW50c0NvbnRhaW5lci5wcmVwZW5kKG5ld0NhcmRFbGVtZW50KTtcbiAgfSk7XG59KTtcbnBvcHVwVGFyamV0YS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBDcmVhciBpbnN0YW5jaWEgZGUgbGEgY2xhc2UgVXNlckluZm9cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXG4gIHJvbGVTZWxlY3RvcjogXCIucHJvZmlsZV9fcm9sZVwiLFxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9fYXZhdGFyLWltYWdlXCIsXG59KTtcblxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHRpdGxlSW5wdXQudmFsdWUgPSBcIlwiO1xuICB1cmxJbnB1dC52YWx1ZSA9IFwiXCI7XG4gIHBvcHVwVGFyamV0YS5vcGVuKCk7XG59KTtcblxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBuYW1lSW5wdXQudmFsdWUgPSBuYW1lRWxlbWVudC50ZXh0Q29udGVudDtcbiAgYWJvdXRNZUlucHV0LnZhbHVlID0gcm9sZUVsZW1lbnQudGV4dENvbnRlbnQ7XG4gIHBvcHVwUHJvZmlsZS5vcGVuKCk7XG59KTtcblxubGV0IGN1cnJlbnRDYXJkID0gbnVsbDtcbi8vIENyZWFyIGluc3RhbmNpYSBkZSBsYSBjbGFzZSBQb3B1cFdpdGhDb25maXJtYXRpb25cbmNvbnN0IGNvbmZpcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIjY29uZmlybVBvcHVwXCIsICgpID0+IHtcbiAgLy8gQXF1w60gYWdyZWdhcsOtYXMgZWwgY8OzZGlnbyBwYXJhIGVsaW1pbmFyIGxhIHRhcmpldGFcbiAgaWYgKGN1cnJlbnRDYXJkKSB7XG4gICAgYXBpLmRlbGV0ZUNhcmQoY3VycmVudENhcmQuX2lkKS50aGVuKCgpID0+IHtcbiAgICAgIGN1cnJlbnRDYXJkLmNhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgICAgY29uc29sZS5sb2coXCJUYXJqZXRhIGVsaW1pbmFkYVwiKTtcbiAgICB9KTtcbiAgfVxufSk7XG5cbmNvbmZpcm1Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBBZ3JlZ2FyIGVsIGV2ZW50IGxpc3RlbmVyIGFsIMOtY29ubyBkZSBsYSBwYXBlbGVyYVxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5lbGVtZW50X190cmFzaFwiKS5mb3JFYWNoKCh0cmFzaEljb24pID0+IHtcbiAgdHJhc2hJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY29uZmlybVBvcHVwLm9wZW4oKTtcbiAgfSk7XG59KTtcblxuY29uc3QgcG9wdXBBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF9hdmF0YXJcIiwgKHsgYXZhdGFyIH0pID0+IHtcbiAgcmV0dXJuIGFwaS51cGRhdGVBdmF0YXIoeyBhdmF0YXIgfSkudGhlbigoZGF0YSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoZGF0YS5hdmF0YXIpO1xuICB9KTtcbn0pO1xuXG5wb3B1cEF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xuXG5hdmF0YXJOb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHBvcHVwQXZhdGFyLm9wZW4oKTtcbn0pO1xuIl0sIm5hbWVzIjpbIkNhcmQiLCJkYXRhIiwidGVtcGxhdGVTZWxlY3RvciIsIl9yZWYiLCJjdXJyZW50VXNlciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZXJEZWxldGVDYXJkIiwiaGFuZGxlckFkZExpa2UiLCJoYW5kbGVyUmVtb3ZlTGlrZSIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfbGlrZXMiLCJsaWtlcyIsIl9pZCIsIl9vd25lciIsIm93bmVyIiwiX2N1cnJlbnRVc2VyIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZXJEZWxldGVDYXJkIiwiX2hhbmRsZXJBZGRMaWtlIiwiX2hhbmRsZXJSZW1vdmVMaWtlIiwia2V5IiwidmFsdWUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZEVsZW1lbnQiLCJfdGhpcyIsInRyYXNoSWNvbiIsImxpa2VCdXR0b24iLCJpbWFnZU5vZGUiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhc0xpa2VPd25lciIsInRoZW4iLCJjYXJkIiwidGV4dENvbnRlbnQiLCJsZW5ndGgiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJfdGhpczIiLCJzb21lIiwibGlrZSIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwic3JjIiwiYWx0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2lzTWUiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9zZXR0aW5ncyIsIl9mb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImNvbmNhdCIsImlkIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImlzRm9ybVZhbGlkIiwiX2lucHV0TGlzdCIsImV2ZXJ5IiwiaXNBbnlGaWVsZEZpbGxlZCIsInRyaW0iLCJzdWJtaXRCdXR0b24iLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvbiIsImZvckVhY2giLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiY29udGFpbmVyIiwiaXRlbSIsImVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImV2ZW50IiwiY2xvc2UiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhJbWFnZSIsIl9Qb3B1cCIsIl9jYWxsU3VwZXIiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cFRpdGxlIiwiX2luaGVyaXRzIiwiaW1hZ2VTcmMiLCJpbWFnZUFsdCIsIl9nZXQiLCJfZ2V0UHJvdG90eXBlT2YiLCJwcm90b3R5cGUiLCJjYWxsIiwic3R5bGUiLCJkaXNwbGF5IiwiUG9wdXBXaXRoRm9ybSIsInN1Ym1pdENhbGxiYWNrIiwiX3N1Ym1pdENhbGxiYWNrIiwiX2Zvcm0iLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmaW5hbGx5IiwicmVzZXQiLCJVc2VySW5mbyIsIm5hbWVTZWxlY3RvciIsInJvbGVTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX3JvbGVFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJyb2xlIiwiX3JlZjIiLCJhYm91dCIsImF2YXRhciIsIlBvcHVwV2l0aENvbmZpcm1hdGlvbiIsImNvbmZpcm1DYWxsYmFjayIsIl9jb25maXJtQ2FsbGJhY2siLCJfeWVzQnV0dG9uIiwiX25vQnV0dG9uIiwiQXBpIiwib3B0aW9ucyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsImZldGNoIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiY2FyZElkIiwiYXV0aG9yaXphdGlvbiIsIm5hbWVFbGVtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyb2xlRWxlbWVudCIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJlbGVtZW50c0NvbnRhaW5lciIsImF2YXRhck5vZGUiLCJjb25maWdGb3JtIiwiZm9ybVNlbGVjdG9yIiwic2VjdGlvbiIsInNob3dJbWFnZVBvcHVwIiwicG9wdXBXaXRoSW1hZ2UiLCJvcGVuIiwiYXBpIiwiZ2V0VXNlckluZm8iLCJ1c2VyIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJjYXJkcyIsImN1cnJlbnRDYXJkIiwiY29uZmlybVBvcHVwIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJnZW5lcmF0ZUNhcmQiLCJhZGRJdGVtIiwicmVuZGVyZXJJdGVtcyIsImVkaXRQcm9maWxlRm9ybSIsIm5ld0NhcmRGb3JtIiwiYXZhdGFyRm9ybSIsImVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciIsIm5ld0NhcmRGb3JtVmFsaWRhdG9yIiwibmV3QXZhdGFyRm9ybVZhbGlkYXRvciIsImVuYWJsZVZhbGlkYXRpb24iLCJwb3B1cEluc3RhbmNlIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJwb3B1cFByb2ZpbGUiLCJ1cGRhdGVVc2VySW5mbyIsInBvcHVwVGFyamV0YSIsInRpdGxlIiwidXJsIiwiYWRkQ2FyZCIsIm5ld0NhcmRFbGVtZW50IiwicHJlcGVuZCIsInRpdGxlSW5wdXQiLCJ1cmxJbnB1dCIsIm5hbWVJbnB1dCIsImFib3V0TWVJbnB1dCIsImRlbGV0ZUNhcmQiLCJjb25zb2xlIiwibG9nIiwicG9wdXBBdmF0YXIiLCJfcmVmMyIsInVwZGF0ZUF2YXRhciJdLCJzb3VyY2VSb290IjoiIn0=